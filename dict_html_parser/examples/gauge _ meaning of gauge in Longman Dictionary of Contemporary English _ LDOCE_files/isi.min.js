function updateText(e){contentElem.innerHTML=formatText(e)}function init(){settings&&initScroll({scrollSpeed:settings.scrollSpeed,scrollAmount:settings.scrollAmount,scrollDelay:settings.scrollDelay})}function initScroll(e){var t;!BannerFlow.editorMode&&!BannerFlow.imageGeneratorMode&&e&&settings.autoScroll&&(0==scrollCount&&setTimeout(function(){t=setInterval(function(){contentElem.scrollTop>=contentElem.scrollThumbHeight-contentElem.offsetHeight&&(scrollUp=!0,scrollDown=!1,clearInterval(t)),contentElem.scrollTop<=0&&(scrollDown=!0,scrollUp=!1),scrollDown&&(contentElem.scrollTop+=e.scrollAmount)},500-e.scrollSpeed)},1e3*e.scrollDelay),scrollCount++),setupISI(),wrapperElem.addEventListener("mouseover",function(){t&&clearInterval(t)}),wrapperElem.addEventListener("touchstart",function(){t&&clearInterval(t)}),wrapperElem.addEventListener("touchmove",function(){t&&clearInterval(t)})}function setupISI(){if(widgetWidth=BannerFlow.getWidth(),widgetHeight=BannerFlow.getHeight(),styleIsSet)return!1;if(BannerFlow&&settings){contentElem.innerHTML=contentElem.innerHTML.replace("#code#",settings.isiCode),Ps.destroy(contentElem),widgetWidth=BannerFlow.getWidth(),widgetHeight=BannerFlow.getHeight();var e=BannerFlow.getHeight()/10;"left"===settings.expandDirection&&(e=BannerFlow.getHeight()/5),e<8&&(e=8);var t=parseFloat((e/30).toFixed(2));if(Ps.initialize(contentElem,{wheelSpeed:t,minScrollbarLength:30,maxScrollbarLength:e,suppressScrollX:!0}),Ps.update(contentElem),scrollbarRail=document.getElementsByClassName("ps-scrollbar-y-rail")[0],scrollbarThumb=document.getElementsByClassName("ps-scrollbar-y")[0],settings.isExpandable){if(toggleElem.style.display="inline-block",toggleElem.style.paddingTop=settings.expandTextPaddingTop+"px",toggleElem.style.paddingBottom=settings.expandTextPaddingBottom+"px",toggleText.style.color=settings.expandTextColor,toggleText.children[0].innerHTML=settings.expandText,toggleText.children[1].innerHTML=settings.collapseText,settings.expandArrows?(toggleArrow.style.fill=settings.expandArrowsColor,toggleArrow.style.display=""):toggleArrow.style.display="none",settings.expandImages&&2==settings.expandImages.length)for(i in settings.expandImages)-1!=settings.expandImages[i].name.indexOf("expand")&&(toggleText.children[0].innerHTML='<img src="'+settings.expandImages[i].images[0].url+'">'),-1!=settings.expandImages[i].name.indexOf("collapse")&&(toggleText.children[1].innerHTML='<img src="'+settings.expandImages[i].images[0].url+'">')}else toggleElem.style.display="";if(settings.headerText?headerElem.children[0].innerHTML=settings.headerText:settings.headerImage&&(headerElem.children[0].innerHTML='<img src="'+settings.headerImage[0].images[0].url+'">'),settings.expandPositionRight>0&&settings.expandPositionTop>0){var n=toggleElem.innerHTML;"toggle"!=contentElem.childNodes[0].id&&(contentElem.insertAdjacentHTML("afterbegin",'<div id="toggle">'+n+"</div>"),headerElem.removeChild(toggleElem)),(toggleElem=document.getElementById("toggle")).style.right=settings.expandPositionRight+"px",toggleElem.style.top=settings.expandPositionTop+"px"}else(settings.expandPositionRight>0||settings.expandPositionTop>0)&&(settings.expandPositionRight>0&&(toggleElem.style.marginRight=settings.expandPositionRight+"px"),settings.expandPositionTop>0&&(toggleElem.style.marginTop=settings.expandPositionTop+"px"));toggleElem.addEventListener("click",function(){"expanded"==wrapperElem.className?triggerCollapse():triggerExpand()}),settings.isReplayable?(replayElem.style.display="block",replayElem.style.color=settings.replayColor,replayElem.style.background=settings.replayBackground):replayElem.style.display="",""===settings.textPadding&&(settings.textPadding=0),setTimeout(function(){var t=widgetHeight-headerElem.offsetHeight-replayElem.offsetHeight-settings.offsetAmount;isiWrapper.style.height=t+"px",Ps.update(contentElem);var n=buildCSS(30,e);window.showIsiCSS=function(){console.log(n.replace(/}/g,"}\n").replace(/{/g,"{\n").replace(/;/g,";\n"))},document.getElementById("isiStyle")&&document.head.removeChild(document.getElementById("isiStyle"));var r=document.head||document.getElementById("head")[0],s=document.createElement("style");s.type="text/css",s.styleSheet?s.styleSheet.cssText=n:s.appendChild(document.createTextNode(n)),s.id="isiStyle",r.appendChild(s),Ps.update(contentElem),styleIsSet=!0,BannerFlow.imageGeneratorMode&&(contentElem.scrollTop+=1,contentElem.scrollTop=0,Ps.update(contentElem)),wrapperElem.style.opacity="",BannerFlow.raiseEvent("isiCollapse"),BannerFlow.play()},100)}}function buildCSS(e,t){var n="";return settings.scrollButtons||(settings.scrollArrowHeight=0,settings.scrollOffset=0,n+=".scrollButton{ display: none!important; }"),n+=".dummy-rail{width:"+settings.scrollWidth+"px!important;margin-top:"+(settings.scrollArrowHeight+settings.scrollOffset)+"px;background:"+settings.scrollRailColor+"!important;height: calc(100% - "+2*settings.scrollArrowHeight+"px);"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",n+="#header, #replay-wrapper, #container{ background: "+settings.backgroundColor+"; }#isi-wrapper, #container, #offset{ "+css3pf("transition","height "+settings.expandTransitionDuration+"s ease-in-out")+";}#content{padding-left: "+settings.textPaddingLeft+"px;padding-right:"+(settings.textPaddingRight+settings.scrollWidth)+"px;font-size:"+settings.textSize+"px;line-height: "+settings.textLineHeight+"px;color: "+settings.textColor+";}#content a{ color: "+settings.linkColor+";}#content.expanded{height:"+widgetHeight+"px;}.scrollButton {width: "+(settings.scrollWidth-2)+"px!important;height: "+(settings.scrollArrowHeight-2)+"px!important;background: "+settings.scrollButtonColor+"!important;}#scrollUp { margin-top:"+settings.scrollOffset+"px;}.scrollButton svg {fill: "+settings.scrollButtonArrowColor+"!important;}","up"===settings.expandDirection&&(offsetElem.style.height=settings.offsetAmount+"px",offsetElem.style.width="",n+=".ps-container > .ps-scrollbar-y-rail{width:"+settings.scrollWidth+"px!important;height:"+(contentElem.offsetHeight-2*settings.scrollArrowHeight-settings.scrollOffset)+"px!important;margin-top:"+(settings.scrollArrowHeight+settings.scrollOffset)+"px;background:"+settings.scrollRailColor+"!important;"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",n+=".ps-scrollbar-y{width:"+settings.scrollWidth+"px!important;background:"+settings.scrollThumbColor+"!important;"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",n+="#wrapper.expanded #offset{height: 0px!important; }#wrapper.collapsed #offset{height: "+settings.offsetAmount+"px!important;}#wrapper.expanded #isi-wrapper{height: "+(widgetHeight-headerElem.offsetHeight)+"px!important;}",n+="#wrapper.expanded .ps-scrollbar-y{height:"+(t-settings.scrollArrowHeight)+"px!important;}#wrapper.expanded .ps-container > .ps-scrollbar-y-rail{height:"+(widgetHeight-headerElem.offsetHeight-2*settings.scrollArrowHeight-settings.scrollOffset)+"px!important;}",n+="body.partway #wrapper.collapsed #offset{height: "+settings.partwayOffset+"px!important; }body.partway #wrapper.expanded #isi-wrapper{height: "+(widgetHeight-headerElem.offsetHeight)+"px!important;}body.partway #wrapper.collapsed #isi-wrapper{height: "+(widgetHeight-settings.partwayOffset-headerElem.offsetHeight)+"px!important;}"),"left"===settings.expandDirection&&(offsetElem.style.width="100%",offsetElem.className="left",isiWrapper.style.height=widgetHeight-headerElem.offsetHeight-replayElem.offsetHeight+"px",isiWrapper.style.float="right",containerElem.style.height="100%",n+=".ps-container > .ps-scrollbar-y-rail{width:"+settings.scrollWidth+"px!important;height:"+(contentElem.offsetHeight-2*settings.scrollArrowHeight-settings.scrollOffset)+"px!important;margin-top:"+(settings.scrollArrowHeight+settings.scrollOffset)+"px;background:"+settings.scrollRailColor+"!important;"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",n+=".ps-scrollbar-y{width:"+settings.scrollWidth+"px!important;background:"+settings.scrollThumbColor+"!important;"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",n+="#wrapper #isi-wrapper{ "+css3pf("transition","width "+settings.expandTransitionDuration+"s ease-in-out")+"; height: 100%; }#wrapper.collapsed #isi-wrapper{width: "+(widgetWidth-settings.offsetAmount)+"px!important;}#wrapper.expanded #isi-wrapper{width: "+widgetWidth+"px!important;}#wrapper #toggle-arrow {"+css3pf("transform","rotate(-90deg)")+";}",n+="#wrapper.expanded .ps-scrollbar-y{height:"+(t-settings.scrollArrowHeight)+"px!important;;}#wrapper.expanded .ps-container > .ps-scrollbar-y-rail{height:"+(widgetHeight-headerElem.offsetHeight-2*settings.scrollArrowHeight-settings.scrollOffset)+"px!important;}",n+="body.partway #wrapper.expanded #isi-wrapper{width: "+widgetWidth+"px!important;}body.partway #wrapper.collapsed #isi-wrapper{width: "+(widgetWidth-settings.partwayOffset)+"px!important;}"),n}function bindClicksToEventlisteners(){var e=document.querySelectorAll("a");for(i=0;i<e.length;i++)e[i].addEventListener("click",function(){-1!=this.getAttribute("data-link").indexOf("mailto:")?window.location.href=this.getAttribute("data-link"):BannerFlow.open(this.getAttribute("data-link"))})}function triggerExpand(){wrapperElem.className="expanded",toggleElem.className="expanded",setTimeout(function(){contentElem.scrollTop=0,Ps.update(contentElem),BannerFlow.pause(),BannerFlow.raiseEvent("isiExpand")},50)}function triggerCollapse(){wrapperElem.className="collapsed",toggleElem.className="collapsed",setTimeout(function(){contentElem.scrollTop=0,Ps.update(contentElem),BannerFlow.raiseEvent("isiCollapse"),canPause&&BannerFlow.play()},50)}function css3pf(e,t){return"-webkit-"+e+":"+t+";-moz-"+e+":"+t+";-ms-"+e+":"+t+";"+e+":"+t}function formatText(e){return e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/<div>/g,"").replace(/<\/div>/g,"").replace(/<br>/g,"<p>&nbsp;</p>").replace(/#br#/g,"<br>").replace(/-br-/g,"<br>").replace(/href/g,"data-link").replace(/bannerflow\.blob\.core\.windows\.net\/resources/g,"resources.host.bannerflow.com")}function isIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");return r>0&&parseInt(e.substring(r+5,e.indexOf(".",r)),10)}BannerFlow&&(BannerFlow.pause(),BannerFlow.raiseEvent("isiExpand"));var offsetElem=document.getElementById("offset"),headerElem=document.getElementById("header"),wrapperElem=document.getElementById("wrapper"),isiWrapper=document.getElementById("isi-wrapper"),containerElem=document.getElementById("container"),contentElem=document.getElementById("content"),toggleElem=document.getElementById("toggle"),toggleText=document.getElementById("toggle-text"),toggleArrow=document.getElementById("toggle-arrow"),replayElem=document.getElementById("replay-wrapper"),scrollUpButton=document.getElementById("scrollUp");scrollDownButton=document.getElementById("scrollDown");var scrollbarRail=null,scrollbarThumb=null,scrollSpeed=100,scrollAmount=1,scrollDelay=0,settings,styles,styleIsSet=!1,widgetWidth,widgetHeight;BannerFlow.addEventListener(BannerFlow.TEXT_CHANGED,function(){updateText(BannerFlow.text),containerElem.insertAdjacentHTML("beforeend",'<div class="dummy-rail"></div>')}),BannerFlow.addEventListener(BannerFlow.SETTINGS_CHANGED,function(){BannerFlow.editorMode&&(settings=BannerFlow.settings,styleIsSet=!1,setupISI())}),BannerFlow.addEventListener(BannerFlow.STYLE_CHANGED,function(){BannerFlow.editorMode&&(styles=BannerFlow.style,setupISI())}),BannerFlow.addEventListener(BannerFlow.INIT,function(){BannerFlow.editorMode||(settings=BannerFlow.settings,styles=BannerFlow.style),init(),bindClicksToEventlisteners()});var canPause=!0;BannerFlow.addEventListener(BannerFlow.STOP,function(){canPause=!1}),scrollUpButton.addEventListener("click",function(){contentElem.scrollTop-=20,clearInterval(autoScroll)}),scrollDownButton.addEventListener("click",function(){contentElem.scrollTop+=20,clearInterval(autoScroll)}),offsetElem.addEventListener("click",function(){-1!=document.referrer.indexOf("app.bannerflow.com")?window.open(BannerFlow.defaultTargetUrl):BannerFlow.open()}),replayElem.addEventListener("click",function(){BannerFlow.prevLoop()}),BannerFlow.addEventListener("toggleExpand",function(){triggerExpand()}),BannerFlow.addEventListener("toggleCollapse",function(){triggerCollapse()}),BannerFlow.addEventListener("partwayTransition",function(){document.body.className="partway",setTimeout(function(){contentElem.scrollTop=0,Ps.update(contentElem),contentElem.scrollTop=0,setTimeout(function(){if(BannerFlow){settings.scrollButtons||(settings.arrowHeight=0);var e="body.partway #wrapper.collapsed .ps-scrollbar-y{width:"+settings.scrollWidth+"px!important;height:"+(parseInt(scrollbarThumb.style.height)-settings.scrollArrowHeight)+"px!important;background:"+settings.scrollThumbColor+"!important;"+css3pf("border-radius",settings.scrollbarRoundedCorners+"px!important")+";}",t=document.head||document.getElementById("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),n.id="partway",t.appendChild(n)}},10)},1e3*settings.expandTransitionDuration)});var scrollCount=0;